"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.compress = void 0;
const tslib_1 = require("../tslib.js");
const _gzip_1 = tslib_1.__importDefault(require("#gzip"));
const headers_1 = require("../headers.js");
// Chosen based on limited testing. May need tuning.
const MIN_GZIP_SIZE = 1024;
const compress = async ({ body, bodyHeaders }) => {
    if (typeof body === 'string' && body.length > MIN_GZIP_SIZE) {
        return {
            body: await (0, _gzip_1.default)(body),
            bodyHeaders: (0, headers_1.buildHeaders)([bodyHeaders, { 'content-encoding': 'gzip' }]),
        };
    }
    return { body, bodyHeaders };
};
exports.compress = compress;
//# sourceMappingURL=compress.js.map